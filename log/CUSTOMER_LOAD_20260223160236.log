2026-02-23 16:02:38.729389: Executing query: TRUNCATE TABLE TEMP.TMP_D_CUSTOMER
2026-02-23 16:02:39.547256: Query Result: [('Statement executed successfully.',)]
2026-02-23 16:02:39.547360: Executing query: 
                INSERT INTO TEMP.TMP_D_CUSTOMER
                (CUSTOMER_ID, CUSTOMER_NAME, SEGMENT)
                SELECT DISTINCT CUSTOMER_ID
                ,CUSTOMER_NAME
                ,SEGMENT                
                FROM STAGE.STG_D_CUSTOMER
            
2026-02-23 16:02:40.561998: Query Result: [(2000,)]
2026-02-23 16:02:40.562114: Executing query: 
                MERGE INTO TARGET.TGT_D_CUSTOMER AS TGT
                USING TEMP.TMP_D_CUSTOMER AS TMP
                    ON TGT.CUSTOMER_ID = TMP.CUSTOMER_ID
                WHEN MATCHED THEN
                    UPDATE SET TGT.CUSTOMER_NAME = TMP.CUSTOMER_NAME, 
                    TGT.SEGMENT = TMP.SEGMENT
                WHEN NOT MATCHED THEN
                    INSERT (TGT.CUSTOMER_ID, TGT.CUSTOMER_NAME, TGT.SEGMENT)
                    VALUES (TMP.CUSTOMER_ID, TMP.CUSTOMER_NAME, TMP.SEGMENT);
            
2026-02-23 16:02:41.987005: Query Result: [(0, 2000)]
